<analysis>**original_problem_statement:**
The user requires a comprehensive business management application for a 50-person consulting organization covering HR, Marketing, Sales, Finance, and Consulting projects.

**PRODUCT REQUIREMENTS (based on user clarifications):**
-   **Authentication & Roles:** A comprehensive, customizable role and permissions management system.
-   **Sales Workflow:** A detailed process from Lead → Pricing Plan → SOW → Quotation → Agreement → Approval.
-   **Scope of Work (SOW):** An advanced SOW builder with spreadsheet-style inline editing, version history, status tracking, and document uploads.
-   **Approval Workflows:** A sophisticated, multi-level approval system based on reporting manager hierarchy.
-   **Employees Module:** Manage employee data, including personal details, HR information, and an organizational chart.
-   **Client Master:** A dedicated interface to manage client data.
-   **Expenses Module:** A system for employees to record expenses and submit them for approval.
-   **Reporting Module:** A comprehensive reporting system with downloadable Excel and PDF reports.
-   **Meetings & MOM:** A feature to create and manage Minutes of Meeting (MOM), with different workflows for Sales and Consulting projects. Consulting MOMs must be detailed, linked to client projects/agreements, and track against committed deliverables.

**User's preferred language**: English

**what currently exists?**
The application is a full-stack React/FastAPI app with JWT-based RBAC. It features modules for SOW, Employees, Clients, Expenses, Approvals, and Reporting.

In the last session, the agent implemented two major features:
1.  **Agreement Export:** Users can now download SOW and Agreement documents as Word (.docx) or PDF files from the SOW Builder and Agreements pages.
2.  **Meeting Form with MOM:** A new module was created to capture Minutes of Meeting (MOM), including agenda, discussion points, decisions, and action items.

However, immediately after the MOM feature was delivered, the user provided critical feedback that the implementation is too generic and must be separated into two distinct workflows: a simple one for internal sales meetings and a detailed, project-linked one for billable client consulting meetings.

**Last working item**:
-   **Last item agent was working:** The agent had just finished a generic implementation of the Meeting Form with MOM feature and was met with a user request for significant changes. The user needs to differentiate between Sales and Consulting meetings, where consulting meetings are much more detailed, linked to projects, and measured against commitments in the SOW. The agent's work was stopped pending this new directive.
-   **Status:** IN PROGRESS
-   **Agent Testing Done:** Y (For the generic MOM feature, which is now being reworked)
-   **Which testing method agent to use?** both
-   **User Testing Done:** N (User reviewed the feature and immediately requested a major refactor)

**All Pending/In progress Issue list**:
-   **Issue 1: Refactor Meetings & MOM Module (P0)**
    -   **Description:** The current one-size-fits-all MOM feature does not meet the user's business requirements. It needs to be split into two distinct workflows: a lightweight version for Sales meetings and a detailed, project-linked version for billable Consulting meetings.
    -   **Attempted fixes:** A generic MOM module was created, but it did not account for the different meeting types.
    -   **Next debug checklist:**
        1.  **Backend:**
            -   Modify the  collection schema in  to include a  field ('sales' or 'consulting') and a  or  link for consulting meetings.
            -   Update the Pydantic models (, ) to reflect the new schema.
            -   Refactor the  and  endpoints to handle the different logic for each meeting type.
            -   Add a new data model to track committed meetings from an SOW.
        2.  **Frontend:**
            -   Modify  to allow users to select a meeting type ('Sales' or 'Consulting').
            -   When 'Consulting' is selected, display an additional field to link the meeting to a specific client/project.
            -   The MOM form for consulting meetings should be detailed as implemented, while the form for sales meetings should be simplified (e.g., no action item assignment).
        3.  **Reporting:**
            -   Create a new dashboard or enhance the existing one to report on consulting meetings, tracking actual vs. committed meetings per project.
    -   **Why fix this issue and what will be achieved with the fix?** To align the application with the user's core business process, enabling accurate tracking and billing of client-facing work.
    -   **Status:** NOT STARTED
    -   **Is recurring issue?** N
    -   **Should Test frontend/backend/both after fix?** both
    -   **Blocked on other issue:** None

**In progress Task List**:
-   **Task 1: Refactor Meetings & MOM Module**
    -   **Where to resume:** Start by modifying the backend data models and APIs in  as outlined in Issue 1 above.
    -   **What will be achieved with this?** A fully functional and business-aligned Meetings & MOM module.
    -   **Status:** IN PROGRESS
    -   **Should Test frontend/backend/both after fix?** both
    -   **Blocked on something:** None

**Upcoming and Future Tasks**
-   **Upcoming Tasks:**
    -   **(P1) Enhance Gantt Chart:** Implement draggable bars for date/week adjustments and display performance metrics (completion rate, on-time delivery) in both the SOW Builder and Project Tasks views.
    -   **(P1) RACI Matrix for SOW:** Add an inline-editable RACI (Responsible, Accountable, Consulted, Informed) role assignment feature for each SOW item, with an option to export the matrix to PDF/Excel.
-   **Future Tasks:**
    -   Expand Reporting Module to include the remaining 30+ reports.
    -   Refactor the monolithic  into modular FastAPI routers.
    -   Implement SOW linkages with consultant performance and project roadmap.
    -   Rocket Reach Integration for lead enrichment.
    -   HR Module (Detailed Time Tracking).
    -   Marketing Workflow Module.
    -   Finance and Accounts Flow Module.

**Completed work in this session**
-   **Agreement Export to Word/PDF (DONE):** Implemented backend logic () and frontend buttons (, ) to generate and download SOW/agreement documents.
-   **Initial Meeting Form with MOM (DONE, but requires rework):** Created a new module with backend APIs () and a frontend page () to create and manage Minutes of Meeting.

**Earlier issues found/mentioned but not fixed**
-   **Issue 1: Org Chart is a simplified list, not a hierarchical tree.**
    -   **Debug checklist:** Re-implement the hierarchical chart in  using a safe, non-recursive approach to avoid stack overflows.
    -   **Why to solve this issue and what will be achieved with this?** To fulfill the original user requirement for a visual organizational chart.
    -   **Should Test frontend/backend/both after fix:** frontend
    -   **Is recurring issue?** Y
-   **Issue 2: Monolithic  file.**
    -   **Debug checklist:** Plan and execute the refactoring of  into separate FastAPI routers based on domain (e.g., , , ).
    -   **Why to solve this issue and what will be achieved with this?** To improve code maintainability, scalability, and reduce the risk of conflicts.
    -   **Should Test frontend/backend/both after fix:** backend
    -   **Is recurring issue?** Y

**Known issue recurrence from previous fork**
-   None.

**Code Architecture**


**Key Technical Concepts**
-   **Frontend:** React, Tailwind CSS, Shadcn/UI
-   **Backend:** FastAPI, Pydantic, Motor (async MongoDB)
-   **Database:** MongoDB
-   **Authentication:** JWT with role-based access control (RBAC)
-   **Document Generation:**  for Word,  for PDF.

**key DB schema**
-   **users**: {email, password, name, role}
-   **roles**: {name, permissions}
-   **employees**: {user_id, employee_id, reporting_manager_id}
-   **clients**: {company_name, industry, location, contacts}
-   **expenses**: {employee_id, client_id, items, status}
-   **sow**: {client_id, items: [...], status}
-   **agreements**: {sow_id, content, status}
-   **meetings**: (New) {title, agenda, discussion_points, decisions, action_items, mom_status}
-   **moms**: (New) {meeting_id, content}

**changes in tech stack**
-   None.

**All files of reference**
-   : **Heavily modified** with new endpoints for document generation and the new Meetings/MOM feature.
-   : **New** file containing logic for generating Word and PDF documents.
-   : **New** page for the Meetings & MOM feature.
-   : Modified to add download buttons.
-   : Modified to add download buttons.
-   : Updated with the route for the new meetings page.
-   : Updated with a navigation link for the new meetings page.
-   : Updated to reflect completed features.

**Areas that need refactoring**:
-   **/app/backend/server.py**: This remains a critical issue. The file's size and complexity continue to grow, making it difficult to maintain. A refactoring into FastAPI routers is urgently needed.
-   **/app/frontend/src/pages/meetings/Meetings.js** (and associated backend logic): The entire MOM feature needs to be refactored to support the user's request for separate 'Sales' and 'Consulting' workflows.

**key api endpoints**
-   : (NEW) Downloads an agreement as a .docx file.
-   : (NEW) Downloads an agreement as a .pdf file.
-   : (NEW) Downloads an SOW as a .docx file.
-   : (NEW) Downloads an SOW as a .pdf file.
-   : (NEW) CRUD endpoints for meetings.
-   : (NEW) CRUD endpoints for MOM associated with a meeting.

**Critical Info for New Agent**
-   **Highest Priority:** The most critical task is to address the user's feedback on the **Meeting Form with MOM** feature. Do not proceed with other tasks until this is resolved. The user wants the feature split into two distinct workflows: a simple one for Sales and a detailed, project-linked one for Consulting. Your first action should be to plan and execute this refactor.
-   **Technical Debt:** The monolithic  file is a growing problem. The previous agent added even more code to it. A plan to refactor this file into smaller, domain-specific routers should be proposed to the user after the MOM feature is fixed.
-   The Agreement Export feature is complete and tested. The user's other P1 requests (Gantt chart enhancements, RACI matrix) are the next items in the backlog.

**documents and test reports created in this job**
-   
-   
-    (updated)

**Last 10 User Messages and any pending HUMAN messages**
1.  **Implement p1 all suggestions**: User approved implementing the four P1 features suggested by the agent. (Status: **IN PROGRESS**)
2.  **User clarified requirements for P1 features**: both for performance metrics; Date and week adjustment as well for Gantt drag; Both for applying Gantt changes; Yes for inline editable RACI and PDF/Excel export; Yes for linking MOM to project/client; Yes for creating follow-up tasks from MOM action items. (Status: **RESOLVED**)
3.  **Yes do it p1 / Anyone from p1**: User prompted the agent to start work on the P1 tasks. (Status: **RESOLVED**)
4.  **Where this meetings are linked...**: The user's most recent and critical message. They have reviewed the new MOM feature and found it insufficient. They require a clear distinction between Sales meetings and Consulting meetings, with the latter being linked to specific projects and tracked against commitments. (Status: **PENDING ACTION**)

**Project Health Check:**
-   **Broken:**
    -   No features are currently crashing the application.
-   **Mocked:**
    -   Email sending is still a log-based placeholder.
-   **Needs Rework:**
    -   The entire **Meetings & MOM module** needs to be refactored to meet new user requirements.

**3rd Party Integrations**
-   **react-gantt-timeline:** Requested, but not yet installed.
-   **Rocket Reach:** Requested, but not yet implemented.

**Testing status**
-   **Testing agent used after significant changes:** YES (used for both the Agreement Export and MOM features).
-   **Troubleshoot agent used after agent stuck in loop:** NO
-   **Test files created:**
    -   
    -   
-   **Known regressions:** None.

**Credentials to test flow:**
-   **Admin:**  / 
-   **Manager:**  / 
-   **Executive:**  / 

**What agent forgot to execute**
-   The agent did not get user confirmation on which P1 task to prioritize and chose one (Meeting Form with MOM). This led to implementing a feature that did not fully align with the user's unstated, more nuanced requirements, forcing an immediate rework.
-   The agent continued to add significant logic to the monolithic  file, further increasing technical debt despite it being marked for refactoring.</analysis>
